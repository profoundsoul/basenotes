# 模块机制

#### 传统Web1.0 JS脚本作用
+ 表单验证
+ 特效

#### JS先天缺陷

+ 模块化系统，有的更多的是<script>标签太过于零散
+ 统一标准库极少，例如IO、文件等库
+ 缺乏包管理系统

#### CommonJS的模块规范

+ 模块引用，require 
+ 定义模块，在node中一个文件就是一个模块。exports 或module.exports 对象为一个模块导出对象。
+ 模块标识，通过具体标识或文件路径，可以不加js后缀

#### Node引入模块步骤
+ 路径分析
+ 文件查找
+ 编译执行

常见的Node模块分为两类：
+ 核心模块，模块标识加载具有除缓存外最高优先级；不经文件定位、编译执行。
+ 文件模块

#### 模块加载：
+ 优先从缓存中加载模块
+ 模块标识符分析
    - 核心模块
    - 文件模块
    - 自定义模块，最难以查找；查找node_modules文件目录，并逐级往父级查找，直到找到为止。

***自定义模块查找与JavaScript原型链查找相似，当前文件路径越深，查找越费时***

+ 文件拓展名分析
    - node会按照.js、 .json、 .node以此查找
+ 目录分析和包
    - 优先查找package.json文件中的main节点。如果不存在默认依次查找为 index.js、 index.json、 index.node等文件
